{% extends "base.html" %}
{% load static bootstrap3 i18n %}


{% block css %}
<link rel="stylesheet" href="{% static 'css/custommarker.css' %}"> 
<style>
#map{
  width: 100%;
  height: 800px;
}

.container{
  margin-left: 2px;
  margin-right: 2px;
  padding: 0px;
}
</style>
{% endblock css %}


{% block main %}

{% if not user.is_authenticated %}
  <div class="container-fluid">
    <h4>
    If you sign up, all records will be saved and available for future use.<a href="{% url 'login' %}"> <button class="btn btn-primary">Sign Up</button> </a></h4>
     
  </div>
{% endif %}

<div class="container">

  <div class="col-xs-12 col-sm-2">
    <strong>Pictures</strong>
  </div>
  <div class="col-xs-12 col-sm-10">
    {% if position.get_picture_count > 1 %}
      <p>You can see the location of all the individual pictures.</p>
    {% endif %}
    {% for picture in position.pictures.all %}
      {% for pos in picture.positions.all %}
        {% if position != pos %}
          <a href="{{ pos.get_absolute_url }}"> 
            <img class="ratio img-circle" src="{{picture.file.url}}" alt="{{picture.name}}">
          </a>
        {% endif %}
      {% endfor %}
    {% endfor %}
  </div> 
  <hr>
  <div class="col-xs-12 col-sm-2">
    <strong>Anchor</strong>
  </div>  
  <div class="col-xs-12 col-sm-10">
    <a href="http://{{ request.get_host }}/onmap/{{position.slug}}/" target="blank">
      <span> http://{{ request.get_host }}/onmap/{{position.slug}}/</span>
    </a> <button class="btn btn-danger" onclick="copyToClipboard()">
      Copy to clipboard
    </button><br>
    <input type="text" id="id_copyurl" value="http://{{ request.get_host }}/onmap/{{position.slug}}/" >
    
<pre>&lt;a href='http://{{ request.get_host }}/onmap/{{position.slug}}/' target='blank'&gt;
    &lt;img src='Picture Name' alt='{{position.name}}'&gt;
&lt;/a&gt;</pre> 
  </div>  
  <div class="col-xs-12 col-sm-2">
    <strong>Map</strong>
  </div>  
  <div class="col-xs-12 col-sm-10">
    <div id="map"></div>
  </div>
</div>
{% endblock main %}


{% block javascript %}

{% if china %}
  <script async defer
src="https://ditu.google.cn/maps/api/js?key=AIzaSyD03p1K9oToraWXg-EsjsV7I06xwKaQ1do&callback=initMap"></script>
</script>
{% else %}
  <script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD03p1K9oToraWXg-EsjsV7I06xwKaQ1do&callback=initMap"></script>
{% endif %}

{% include 'onmap/displayonmap.js' %}
<script>
function copyToClipboard() {
  var copyText = document.getElementById("id_copyurl");
  copyText.select();
  document.execCommand("Copy");
  alert("Copied the url: " + copyText.value);
}
</script>

{% endblock javascript %}
