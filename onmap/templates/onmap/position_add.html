{% extends "base.html" %}
{% load static bootstrap3 i18n %}


{% block css %}
<link href="{% static 'css/picture.css' %}" rel="stylesheet" > 
<style>
.upload{
  height: 80px;
}
.img{
  margin: 2px 5px;
}
</style>
{% endblock css %}


{% block main %}
<div class="container-fluid">
  <div class="row">
      <div class="col-sm-offset-2 col-sm-8">
          <div class="user-title">
            <h2 class="form-title"> {% trans "New Post" %} </h2>
          </div>
          <div class="body">
            <form action="" method="post" enctype="multipart/form-data" id="form-post">
              <div class="preview">
                <div class="upload">
                  <span class="preview-bg"></span>
                  <p class="preview-title"> {% trans "Add post picture" %} </p>
                </div>
                <div id="img_id"></div>
              </div>

              {% csrf_token %}
              {% bootstrap_form form %}
              
              <input type="submit" id="btn_ok" class="btn btn-lg btn-primary btn-block" value="Confirm" />
            </form>
          </div>
      </div>
      <div class="dummy"></div>
  </div>
</div>
{% endblock main %}


{% block javascript %}

<script type="text/javascript">

$(function() {
  $("#id_pictures").change(function() {
    if (this.files && this.files[0]) {
      for (var i = 0; i < this.files.length; i++) {
        console.log("Count : " + i);
        var reader = new FileReader();
        reader.onload = imageIsLoaded;
        reader.readAsDataURL(this.files[i]);
      }
    }
    $(".upload").hide();
  });
});

function imageIsLoaded(e) {
  $('#img_id').append('<img class="img" src="' + e.target.result + '" width="150px"  height="150px">');
};

$(document).on('click', '.upload', function(){
    $("#id_pictures").click();
});

</script>

{% endblock javascript %}
